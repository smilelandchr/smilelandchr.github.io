---
layout:     post
title:         2020-02-21-常微分方程解法（1）
subtitle:   常微分方程的离散化
date:        2020-02-21
author:     SMILELAND
header-img: img/post-bg-universe.jpg
catalog: true
tags:
    - 微分方程
    - 离散化
---

在进行电弧模型建模时候，传统的cassie电弧模型的写法都是连续的，但是连续状态的采样率设置上就出现了问题，无法按照自己期望的采样率进行仿真，所以需要对模型进行离散化处理。

转自csdn

![enter description here](https://i.loli.net/2020/02/21/p2w71GuXnYMhzqP.png)

建立微分方程只是解决问题的第一步通常需要求出方程的解来说明实际现象，并加以检验。如果能得到即系形式的解固然是便于分析和应用的，但是我们知道，只有线性常系数微分方程，并且自由项是某些特殊类型的函数时，才可以肯定得到这样的解，而绝大多数变系数方程、非线性方程都是所谓“解不出来”的，即使看起来非常简单的方程如$\frac{d y}{d x}=y^{2}+x^{2}$，对于用微分方程解决实际问题来说，数值解法就是一个十分重要的手段。

## 1. 常微分方程离散化

下面主要讨论一阶常微分方程的初值问题，其一般形式是

$$
\left\{\begin{array}{l}
{\frac{d y}{d x}=f(x, y) \quad a \leq x \leq b} \\
{y(a)=y_{0}}
\end{array}\right.\tag{1}
$$

在下面讨论中，我们总假定函数$f(x,y)$连续，且关于y满足Lipschitz条件，即存在常数L，使得

$$
|f(x, y)-f(x, \bar{y})| \leq L|y-\bar{y}|
$$

这样，由常微分方程理论知，处置问题（1）的解必定存在唯一。

### 数值解法

所谓数值解法，就是求问题（1）的解$y(x)$在若干点

$a=x_{0}<x_{1}<x_{2}<\cdots<x_{N}=b$处的近似值$y_n(n=1,2,...,N)$，$y_n(n=1,2,...,N)$称为问题（1）的数值解，$h_n=x_{n+1}-x_n$称为由$x_n$到$x_{n+1}$的步长，今后如无特别说明，我们总取步长为常量h。

建立数值解法，首先要将微分方程离散化，一般采用以下几种方法：

#### （i）用差商近似导数——缠粉方程初值问题

若用向前差商$\frac{y\left(x_{n+1}\right)-y\left(x_{n}\right)}{h}$代替$y^{\prime}\left(x_{n}\right)$带入（1）中的微分方程，则得

$$
\frac{y\left(x_{n+1}\right)-y\left(x_{n}\right)}{h} \approx f\left(x_{n}, y\left(x_{n}\right)\right) \quad(n=0,1, \cdots)
$$

简化得

$$
y\left(x_{n+1}\right) \approx y\left(x_{n}\right)+h f\left(x_{n}, y\left(x_{n}\right)\right)
$$

如果用$y(x_n)$的近似值$y_n$带入上式右端，所得结果作为$y(x_{n+1})$的近似值，记为$y_{n+1}$，则有

$$
y_{n+1}=y_{n}+h f\left(x_{n}, y_{n}\right) \quad(n=0,1, \cdots)\tag{2}
$$

这样，问题（1）的近似解可通过求解下述问题

$$
\left\{\begin{array}{l}
{y_{n+1}=y_{n}+h f\left(x_{n}, y_{n}\right) \quad(n=0,1, \cdots)} \\
{y_{0}=y(a)}
\end{array}\right.\tag{3}
$$

按式（3）由初值$y_0$可逐次算出$y_1,y_2...$。式（3）是个离散化的问题，成为差分方程初值问题。

#### （ii）用数值积分方法

将问题（1）的解表成积分形式，用数值积分方法离散化。例如，对微分方程两端积分，得

$$
y\left(x_{n+1}\right)-y\left(x_{n}\right)=\int_{x_{n}}^{x_{n+1}} f(x, y(x)) d x \quad(n=0,1, \cdots)\tag{4}
$$

右边的积分用矩形公式或梯形公式计算。

#### （iii）Taylor多项式近似

将函数$y(x)$在$x_n$处展开，取一次Taylor多项式近似，则得

$$
y\left(x_{n+1}\right) \approx y\left(x_{n}\right)+h y^{\prime}\left(x_{n}\right)=y\left(x_{n}\right)+h f\left(x_{n}, y\left(x_{n}\right)\right)
$$

再将$y(x_n)$的近似值$y_n$代入上式右端，所得结果作为$y(x_{n+1})$的近似值$y_{n+1}$，得到离散化的计算公式

$$
y_{n+1}=y_{n}+h f\left(x_{n}, y_{n}\right)
$$

以上三种方法都是将微分方程离散化的常用方法，每一类方法又可导出不同形式的计算公式。其中Taylor展开法，不仅可以得到求数值解的公式，而且容易估计截断误差。

